names(uga.data) <- attributes(uga.data)[4]$variable.labels
setwd("G:/My Drive/Work/GitHub/consumption-floor/")
uga.data <- read.spss("project-data/UGIR7BFL.SAV", to.data.frame=T)
required.packages <- c("reshape2","ggplot2","data.table","foreign")
lapply(required.packages, require, character.only=T)
setwd("G:/My Drive/Work/GitHub/consumption-floor/")
uga.data <- read.spss("project-data/UGIR7BFL.SAV", to.data.frame=T)
names(uga.data) <- attributes(uga.data)[4]$variable.labels
uga.data$`All woman factor - wealth index`
uga.data$`Wealth index combined`
uga.data$`Wealth index factor score combined (5 decimals)`
plot(uga.data$`Wealth index factor score combined (5 decimals)`, type='h')
hist(uga.data$`Wealth index factor score combined (5 decimals)`)
hist(uga.data$`Wealth index factor score combined (5 decimals)`, bins=100)
?hist
hist(uga.data$`Wealth index factor score combined (5 decimals)`, breaks=100)
hist(uga.data$`Wealth index factor score combined (5 decimals)`, breaks=50)
hist(uga.data$`Wealth index factor score combined (5 decimals)`/10000, breaks=50)
hist(uga.data$`Wealth index factor score combined (5 decimals)`/100000, breaks=50)
hist(uga.data$`Wealth index factor score combined (5 decimals)`/100000, breaks=50,density=T)
hist(uga.data$`Wealth index factor score combined (5 decimals)`/100000, breaks=50,freq=F)
uga.wealth <- uga.data$`Wealth index factor score combined (5 decimals)`/100000
uga.wealth <- as.data.frame(uga.data$`Wealth index factor score combined (5 decimals)`/100000)
View(uga.wealth)
names(uga.wealth) <- "wealth.index"
uga.wealth$wealth.index <- uga.wealth$wealth.index + min(uga.wealth$wealth.index)
hist(uga.wealth$wealth.index)
uga.wealth$wealth.index <- uga.wealth$wealth.index - min(uga.wealth$wealth.index)
hist(uga.wealth$wealth.index)
hist(uga.wealth$wealth.index, breaks=100)
hist(uga.wealth$wealth.index, breaks=50)
hist(uga.wealth$wealth.index, breaks=40)
hist(uga.wealth$wealth.index, breaks=25)
hist(uga.wealth$wealth.index, breaks=15)
hist(uga.wealth$wealth.index, breaks=20)
hist(uga.wealth$wealth.index, breaks=30)
uga.wealth$wealth.index[1]
uga.wealth$wealth.index[2]
fgt.index <- function(weights,distribution,z,a){
fgt <- sum((weights*(z-distribution)/z)^a)
return(fgt)
}
fgt.index <- function(weights,distribution,z,a){
fgt <- 1/sum(weights)*sum((weights[which(distribution<z)]*(z-distribution[which(distribution<z)])/z)^a)
return(fgt)
}
uga.wealth$weights <- 1
View(uga.wealth)
fgt.index(uga.wealth$weights,uga.wealth$wealth.index,1,0)
fgt.index(uga.wealth$weights,uga.wealth$wealth.index,1,1)
fgt.index(uga.wealth$weights,uga.wealth$wealth.index,1,2)
sum(uga.wealth$weights[which(uga.wealth$wealth.index<1)])
sum(uga.wealth$weights[which(uga.wealth$wealth.index<1)])/sum(uga.wealth$weights)
hc1 <- fgt.index(uga.wealth$weights,uga.wealth$wealth.index,1,0)
pg1 <- fgt.index(uga.wealth$weights,uga.wealth$wealth.index,1,1)
spg1 <- fgt.index(uga.wealth$weights,uga.wealth$wealth.index,1,2)
floor1 <- 1-spg1/pg1
floor <- z*(1-fgt.index(weights,distribution,z,c+1)/fgt.index(weights,distribution,z,c))
floor.calc <- function(weights,distribution,z,c=1){
floor <- z*(1-fgt.index(weights,distribution,z,c+1)/fgt.index(weights,distribution,z,c))
}
floor.calc <- function(weights,distribution,z,c=1){
floor <- z*(1-fgt.index(weights,distribution,z,c+1)/fgt.index(weights,distribution,z,c))
return(floor)
}
floor.calc(uga.wealth$weights,uga.wealth$wealth.index,1)
summary(uga.wealth$wealth.index)
?density
density(uga.wealth$wealth.index)
density(uga.wealth$wealth.index,weights=uga.wealth$weights)
uga.wealth$weights <- 1/length(uga.wealth$wealth.index)
density(uga.wealth$wealth.index,weights=uga.wealth$weights)
density(uga.wealth$wealth.index,weights=uga.wealth$weights)$x
density(uga.wealth$wealth.index,weights=uga.wealth$weights)[which(density(uga.wealth$wealth.index,weights=uga.wealth$weights)$y=max(density(uga.wealth$wealth.index,weights=uga.wealth$weights)$y))]$x
density(uga.wealth$wealth.index,weights=uga.wealth$weights)[which(density(uga.wealth$wealth.index,weights=uga.wealth$weights)$y==max(density(uga.wealth$wealth.index,weights=uga.wealth$weights)$y))]$x
density(uga.wealth$wealth.index,weights=uga.wealth$weights)$y==max(density(uga.wealth$wealth.index,weights=uga.wealth$weights)$y)
density(uga.wealth$wealth.index,weights=uga.wealth$weights)[which(density(uga.wealth$wealth.index,weights=uga.wealth$weights)$y==max(density(uga.wealth$wealth.index,weights=uga.wealth$weights)$y))]
density(uga.wealth$wealth.index,weights=uga.wealth$weights)[(density(uga.wealth$wealth.index,weights=uga.wealth$weights)$y==max(density(uga.wealth$wealth.index,weights=uga.wealth$weights)$y))]
density(uga.wealth$wealth.index,weights=uga.wealth$weights)$x[(density(uga.wealth$wealth.index,weights=uga.wealth$weights)$y==max(density(uga.wealth$wealth.index,weights=uga.wealth$weights)$y))]
density(uga.wealth$wealth.index,weights=uga.wealth$weights)$x[which(density(uga.wealth$wealth.index,weights=uga.wealth$weights)$y==max(density(uga.wealth$wealth.index,weights=uga.wealth$weights)$y))]
mode.kernel <- function(distribution, kernel="g", adjust=1, weights = rep(1/length(distribution))){
dens <- density(distribution, kernel=kernel, adjust=adjust, weights=weights)
mode <- dens$x[which(dens$y==max(dens$y))]
return(mode)
}
mode.kernel(uga.wealth$wealth.index)
mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$weights)
mode.kernel <- function(distribution, kernel="g", adjust=1, weights)
dens <- density(distribution, kernel=kernel, adjust=adjust, weights=weights)
mode <- dens$x[which(dens$y==max(dens$y))]
return(mode)
mode.kernel <- function(distribution, kernel="g", adjust=1, weights){
dens <- density(distribution, kernel=kernel, adjust=adjust, weights=weights)
mode <- dens$x[which(dens$y==max(dens$y))]
return(mode)
}
mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$weights, adjust=0.5)
mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$weights, adjust=0.2)
mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$weights, adjust=0.1)
floor.calc(uga.wealth$weights,uga.wealth$wealth.index,mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$weights))
mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$weights)
wealth.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$weights)
floor.calc(uga.wealth$weights,uga.wealth$wealth.index,wealth.mode)
setwd("G:/My Drive/Work/GitHub/consumption-floor/")
uga.data <- read.spss("project-data/UGIR7BFL.SAV", to.data.frame=T)
names(uga.data) <- attributes(uga.data)[4]$variable.labels
uga.wealth <- as.data.frame(uga.data$`Wealth index factor score combined (5 decimals)`/100000)
names(uga.wealth) <- "wealth.index"
uga.wealth$wealth.index <- uga.wealth$wealth.index - min(uga.wealth$wealth.index)
uga.wealth$weights <- 1/length(uga.wealth$wealth.index)
mode.kernel <- function(distribution, kernel="g", adjust=1, weights){
dens <- density(distribution, kernel=kernel, adjust=adjust, weights=weights)
mode <- dens$x[which(dens$y==max(dens$y))]
return(mode)
}
fgt.index <- function(weights,distribution,z,a){
fgt <- 1/sum(weights)*sum((weights[which(distribution<z)]*(z-distribution[which(distribution<z)])/z)^a)
return(fgt)
}
floor.calc <- function(weights,distribution,z,c=1){
floor <- z*(1-fgt.index(weights,distribution,z,c+1)/fgt.index(weights,distribution,z,c))
return(floor)
}
wealth.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$weights)
floor.calc(uga.wealth$weights,uga.wealth$wealth.index,wealth.mode)
mode.kernel <- function(distribution, kernel="g", adjust=1, weights){
dens <- density(distribution, kernel=kernel, adjust=adjust, weights=weights)
mode <- dens$x[which(dens$y==max(dens$y))]
return(mode)
}
fgt.index <- function(distribution,weights,z,a){
fgt <- 1/sum(weights)*sum((weights[which(distribution<z)]*(z-distribution[which(distribution<z)])/z)^a)
return(fgt)
}
floor.calc <- function(distribution,weights,z,c=1){
floor <- z*(1-fgt.index(weights,distribution,z,c+1)/fgt.index(weights,distribution,z,c))
return(floor)
}
wealth.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$weights)
floor.calc(uga.wealth$wealth.index,uga.wealth$weights,wealth.mode)
uga.wealth$weights <- 1/length(uga.wealth$wealth.index)
mode.kernel <- function(distribution, kernel="g", adjust=1, weights){
dens <- density(distribution, kernel=kernel, adjust=adjust, weights=weights)
mode <- dens$x[which(dens$y==max(dens$y))]
return(mode)
}
fgt.index <- function(distribution,weights,z,a){
fgt <- 1/sum(weights)*sum((weights[which(distribution<z)]*(z-distribution[which(distribution<z)])/z)^a)
return(fgt)
}
floor.calc <- function(distribution,weights,z,c=1){
floor <- z*(1-fgt.index(weights,distribution,z,c+1)/fgt.index(weights,distribution,z,c))
return(floor)
}
wealth.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$weights)
floor.calc(uga.wealth$wealth.index,uga.wealth$weights,wealth.mode)
fgt.index(uga.wealth$wealth.index,uga.wealth$weights,1.418,1)
fgt.index(uga.wealth$wealth.index,uga.wealth$weights,1.418,0)
sum(uga.wealth$weights)
fgt.index <- function(distribution,weights,z,a){
fgt <- (1/sum(weights))*sum((weights[which(distribution<z)]*(z-distribution[which(distribution<z)])/z)^a)
return(fgt)
}
fgt.index(uga.wealth$wealth.index,uga.wealth$weights,1.418,0)
max(uga.wealth$wealth.index)
min(uga.wealth$wealth.index)
fgt.index(uga.wealth$wealth.index,uga.wealth$weights,1,0)
fgt.index(uga.wealth$wealth.index,uga.wealth$weights,1,1)
fgt.index(uga.wealth$wealth.index,uga.wealth$weights,1,2)
uga.wealth$weights <- 1
fgt.index(uga.wealth$wealth.index,uga.wealth$weights,1,0)
fgt.index(uga.wealth$wealth.index,uga.wealth$weights,1,1)
fgt.index(uga.wealth$wealth.index,uga.wealth$weights,1,2)
fgt.index <- function(distribution,weights,z,a){
fgt <- (1/sum(weights))*sum(weights[which(distribution<z)]*((z-distribution[which(distribution<z)])/z)^a)
return(fgt)
}
fgt.index(uga.wealth$wealth.index,uga.wealth$weights,1,0)
uga.wealth$weights <- 1/length(uga.wealth$wealth.index)
fgt.index(uga.wealth$wealth.index,uga.wealth$weights,1,0)
fgt.index(uga.wealth$wealth.index,uga.wealth$weights,1,2)
mode.kernel <- function(distribution, kernel="g", adjust=1, weights){
dens <- density(distribution, kernel=kernel, adjust=adjust, weights=weights)
mode <- dens$x[which(dens$y==max(dens$y))]
return(mode)
}
fgt.index <- function(distribution,weights,z,a){
fgt <- (1/sum(weights))*sum(weights[which(distribution<z)]*((z-distribution[which(distribution<z)])/z)^a)
return(fgt)
}
floor.calc <- function(distribution,weights,z,c=1){
floor <- z*(1-fgt.index(weights,distribution,z,c+1)/fgt.index(weights,distribution,z,c))
return(floor)
}
wealth.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$weights)
floor.calc(uga.wealth$wealth.index,uga.wealth$weights,wealth.mode)
wealth.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$weights)
mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$weights)
floor.calc <- function(distribution,weights,z,c=1){
floor <- z*(1-fgt.index(distribution,weights,z,c+1)/fgt.index(distribution,weights,z,c))
return(floor)
}
wealth.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$weights)
floor.calc(uga.wealth$wealth.index,uga.wealth$weights,wealth.mode)
?unz
temp_unz <- unz("project-data/UGIR7BSV.ZIP", "UGIR7BFL.SAV")
uga.data <- read.spss(temp_unz, to.data.frame=T)
temp_unz <- tempfile()
temp_unz <- unz("project-data/UGIR7BSV.ZIP", "UGIR7BFL.SAV")
uga.data <- read.spss(temp_unz, to.data.frame=T)
temp_unz <- read.spss(unz("project-data/UGIR7BSV.ZIP", "UGIR7BFL.SAV"))
temp_unz <- tempfile()
temp_unz <- unz(filename="project-data/UGIR7BSV.ZIP", open="UGIR7BFL.SAV")
temp_unz <- unz(description ="project-data/UGIR7BSV.ZIP", open="UGIR7BFL.SAV")
temp_unz <- unz(description ="project-data/UGIR7BSV.ZIP", filename ="UGIR7BFL.SAV")
#Download FAO food CPI and total CPI
temp_download <- tempfile()
download.file("http://fenixservices.fao.org/faostat/static/bulkdownloads/ConsumerPriceIndices_E_All_Data.zip",temp_download)
?tempfile
temp_unz <- tempfile()
temp_unz <- unz("project-data/UGIR7BSV.ZIP", "UGIR7BFL.SAV")
unz(temp_download,"ConsumerPriceIndices_E_All_Data_NOFLAG.csv"))
unz(temp_download,"ConsumerPriceIndices_E_All_Data_NOFLAG.csv")
temp_unz
temp_unz <- read.spss(unz("project-data/UGIR7BSV.ZIP", "UGIR7BFL.SAV"))
temp_unz <- unzip("project-data/UGIR7BSV.ZIP", "UGIR7BFL.SAV")
uga.data <- read.spss(temp_unz, to.data.frame=T)
min.wealth <- min(uga.wealth$wealth.index)
uga.wealth <- as.data.frame(uga.data$`Wealth index factor score combined (5 decimals)`/100000)
names(uga.wealth) <- "wealth.index"
min.wealth <- min(uga.wealth$wealth.index)
required.packages <- c("reshape2","ggplot2","data.table","foreign")
lapply(required.packages, require, character.only=T)
setwd("G:/My Drive/Work/GitHub/consumption-floor/")
temp_unz <- unzip("project-data/UGIR7BSV.ZIP", "UGIR7BFL.SAV")
uga.data <- read.spss(temp_unz, to.data.frame=T)
names(uga.data) <- attributes(uga.data)[4]$variable.labels
uga.wealth <- as.data.frame(uga.data$`Wealth index factor score combined (5 decimals)`/100000)
names(uga.wealth) <- "wealth.index"
min.wealth <- min(uga.wealth$wealth.index)
uga.wealth$wealth.index <- uga.wealth$wealth.index - min.wealth
uga.wealth$weights <- 1/length(uga.wealth$wealth.index)
fgt.index <- function(distribution,weights,z,a){
fgt <- (1/sum(weights))*sum(weights[which(distribution<z)]*((z-distribution[which(distribution<z)])/z)^a)
return(fgt)
}
floor.calc <- function(distribution,weights,z,c=1){
floor <- z*(1-fgt.index(distribution,weights,z,c+1)/fgt.index(distribution,weights,z,c))
return(floor)
}
mode.kernel <- function(distribution, kernel="g", adjust=1, weights){
dens <- density(distribution, kernel=kernel, adjust=adjust, weights=weights)
mode <- dens$x[which(dens$y==max(dens$y))]
return(mode)
}
wealth.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$weights)
floor.calc(uga.wealth$wealth.index,uga.wealth$weights,wealth.mode)
uga.floor <- floor.calc(uga.wealth$wealth.index,uga.wealth$weights,wealth.mode) - min.wealth
uga.floor <- floor.calc(uga.wealth$wealth.index,uga.wealth$weights,wealth.mode) + min.wealth
hist(uga.data$`Wealth index factor score combined (5 decimals)`/100000)
uga.data$`Women's individual sample weight (6 decimals)`
sum(uga.data$`Women's individual sample weight (6 decimals)`/1000000)
fgt.index <- function(distribution,weights,z,a){
fgt <- (1/sum(weights))*sum(weights[which(distribution<z)]*((z-distribution[which(distribution<z)])/z)^a)
return(fgt)
}
uga.wealth$wom.weights <- (uga.data$`Women's individual sample weight (6 decimals)`/sum(uga.data$`Women's individual sample weight (6 decimals)`))/1000000
wealth.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$ind.weights)
uga.floor <- floor.calc(uga.wealth$wealth.index,uga.wealth$ind.weights,wealth.mode) + min.wealth
wealth.wom.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$wom.weights)
uga.wealth$wom.weights <- (uga.data$`Women's individual sample weight (6 decimals)`/sum(uga.data$`Women's individual sample weight (6 decimals)`))
wealth.wom.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$wom.weights)
uga.wom.floor <- floor.calc(uga.wealth$wealth.index,uga.wealth$ind.weights,wealth.wom.mode) + min.wealth
uga.wealth <- as.data.frame(uga.data$`Wealth index factor score combined (5 decimals)`/100000)
names(uga.wealth) <- "wealth.index"
min.wealth <- min(uga.wealth$wealth.index)
uga.wealth$wealth.index <- uga.wealth$wealth.index - min.wealth
uga.wealth$ind.weights <- 1/length(uga.wealth$wealth.index)
uga.wealth$wom.weights <- (uga.data$`Women's individual sample weight (6 decimals)`/sum(uga.data$`Women's individual sample weight (6 decimals)`))
fgt.index <- function(distribution,weights,z,a){
fgt <- (1/sum(weights))*sum(weights[which(distribution<z)]*((z-distribution[which(distribution<z)])/z)^a)
return(fgt)
}
floor.calc <- function(distribution,weights,z,c=1){
floor <- z*(1-fgt.index(distribution,weights,z,c+1)/fgt.index(distribution,weights,z,c))
return(floor)
}
mode.kernel <- function(distribution, kernel="g", adjust=1, weights){
dens <- density(distribution, kernel=kernel, adjust=adjust, weights=weights)
mode <- dens$x[which(dens$y==max(dens$y))]
return(mode)
}
wealth.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$ind.weights)
uga.floor <- floor.calc(uga.wealth$wealth.index,uga.wealth$ind.weights,wealth.mode) + min.wealth
wealth.wom.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$wom.weights)
uga.wom.floor <- floor.calc(uga.wealth$wealth.index,uga.wealth$ind.weights,wealth.wom.mode) + min.wealth
uga.data$`Wealth index for urban/rural`
uga.data$`Ultimate area unit`
uga.data$Region
uga.data$`Country code and phase`
uga.data$`Type of place of residence`
uga.wealth$urban.weights <- 0
uga.wealth$urban.weights[which(uga.data$`Type of place of residence`=="Urban")] <- 1
uga.wealth$rural.weights <- 0
uga.wealth$rural.weights[which(uga.data$`Type of place of residence`=="Rural")] <- 1
View(uga.wealth)
length(uga.data$`Type of place of residence`[which(uga.data$`Type of place of residence`=="Urban")])
length(uga.data$`Type of place of residence`[which(uga.data$`Type of place of residence`=="Rural")])
length(uga.wealth$wealth.index)
uga.wealth$urban.weights <- 0
uga.wealth$urban.weights[which(uga.data$`Type of place of residence`=="Urban")] <- 1/length(uga.data$`Type of place of residence`[which(uga.data$`Type of place of residence`=="Urban")])
uga.wealth$rural.weights <- 0
uga.wealth$rural.weights[which(uga.data$`Type of place of residence`=="Rural")] <- 1/length(uga.data$`Type of place of residence`[which(uga.data$`Type of place of residence`=="Rural")])
wealth.urb.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$urban.weights)
wealth.rur.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$rural.weights)
hist(subset(uga.wealth, urban.weights > 0)$wealth.index)
hist(subset(uga.wealth, rural.weights > 0)$wealth.index)
hist(subset(uga.wealth, urban.weights > 0)$wealth.index)
hist(subset(uga.wealth, rural.weights > 0)$wealth.index)
uga.urb.floor <- floor.calc(uga.wealth$wealth.index, weights=uga.wealth$urban.weights)
uga.urb.floor <- floor.calc(uga.wealth$wealth.index, weights=uga.wealth$urban.weights, wealth.urb.mode)
uga.rur.floor <- floor.calc(uga.wealth$wealth.index, weights=uga.wealth$rural.weights, wealth.rur.mode)
hist(subset(uga.wealth, urban.weights > 0)$wealth.index)
uga.urb.floor <- floor.calc(uga.wealth$wealth.index, weights=uga.wealth$urban.weights, wealth.urb.mode) + min.wealth
uga.rur.floor <- floor.calc(uga.wealth$wealth.index, weights=uga.wealth$rural.weights, wealth.rur.mode) + min.wealth
rm(list=ls())
required.packages <- c("reshape2","ggplot2","data.table","foreign")
lapply(required.packages, require, character.only=T)
setwd("G:/My Drive/Work/GitHub/consumption-floor/")
temp_unz <- unzip("project-data/UGIR7BSV.ZIP", "UGIR7BFL.SAV")
uga.data <- read.spss(temp_unz, to.data.frame=T)
names(uga.data) <- attributes(uga.data)[4]$variable.labels
uga.wealth <- as.data.frame(uga.data$`Wealth index factor score combined (5 decimals)`/100000)
names(uga.wealth) <- "wealth.index"
min.wealth <- min(uga.wealth$wealth.index)
uga.wealth$wealth.index <- uga.wealth$wealth.index - min.wealth
uga.wealth$ind.weights <- 1/length(uga.wealth$wealth.index)
uga.wealth$wom.weights <- (uga.data$`Women's individual sample weight (6 decimals)`/sum(uga.data$`Women's individual sample weight (6 decimals)`))
uga.wealth$urban.weights <- 0
uga.wealth$urban.weights[which(uga.data$`Type of place of residence`=="Urban")] <- 1/length(uga.data$`Type of place of residence`[which(uga.data$`Type of place of residence`=="Urban")])
uga.wealth$rural.weights <- 0
uga.wealth$rural.weights[which(uga.data$`Type of place of residence`=="Rural")] <- 1/length(uga.data$`Type of place of residence`[which(uga.data$`Type of place of residence`=="Rural")])
fgt.index <- function(distribution,weights,z,a){
fgt <- (1/sum(weights))*sum(weights[which(distribution<z)]*((z-distribution[which(distribution<z)])/z)^a)
return(fgt)
}
floor.calc <- function(distribution,weights,z,c=1){
floor <- z*(1-fgt.index(distribution,weights,z,c+1)/fgt.index(distribution,weights,z,c))
return(floor)
}
mode.kernel <- function(distribution, kernel="g", adjust=1, weights){
dens <- density(distribution, kernel=kernel, adjust=adjust, weights=weights)
mode <- dens$x[which(dens$y==max(dens$y))]
return(mode)
}
wealth.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$ind.weights)
uga.floor <- floor.calc(uga.wealth$wealth.index,uga.wealth$ind.weights,wealth.mode) + min.wealth
wealth.wom.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$wom.weights)
uga.wom.floor <- floor.calc(uga.wealth$wealth.index,uga.wealth$ind.weights,wealth.wom.mode) + min.wealth
wealth.urb.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$urban.weights)
wealth.rur.mode <- mode.kernel(uga.wealth$wealth.index, weights=uga.wealth$rural.weights)
uga.urb.floor <- floor.calc(uga.wealth$wealth.index, weights=uga.wealth$urban.weights, wealth.urb.mode) + min.wealth
uga.rur.floor <- floor.calc(uga.wealth$wealth.index, weights=uga.wealth$rural.weights, wealth.rur.mode) + min.wealth
