targetHC=0.01
year=2015
lowerguess=0
upperguess=2
precision=0.005
data.list <- list()
PLs <- seq(lowerguess,upperguess,by=precision)
pb <- txtProgressBar(min=0, max=length(PLs),style=3)
for (i in 1:length(PLs)){
param <- paste0("Countries=all&RefYears=",year,"&PovertyLine=",PLs[i])
url <- paste0("http://iresearch.worldbank.org/PovcalNet/PovcalNetAPI.ashx?",param,"&display=c")
temp <- read.csv(url,header=T)
data.list[[i]] <- temp
setTxtProgressBar(pb,i)
}
close(pb)
data <- rbindlist(data.list)
data$diff <- abs(targetHC-data$HeadCount)
required.packages <- c("reshape2","ggplot2","data.table")
lapply(required.packages, require, character.only=T)
setwd("G:/My Drive/Work/GitHub/consumption-floor/")
data.list <- list()
PLs <- seq(lowerguess,upperguess,by=precision)
pb <- txtProgressBar(min=0, max=length(PLs),style=3)
for (i in 1:length(PLs)){
param <- paste0("Countries=all&RefYears=",year,"&PovertyLine=",PLs[i])
url <- paste0("http://iresearch.worldbank.org/PovcalNet/PovcalNetAPI.ashx?",param,"&display=c")
temp <- read.csv(url,header=T)
data.list[[i]] <- temp
setTxtProgressBar(pb,i)
}
close(pb)
data <- rbindlist(data.list)
data$diff <- abs(targetHC-data$HeadCount)
data.list <- list()
PLs <- seq(lowerguess,upperguess,by=precision)
pb <- txtProgressBar(min=0, max=length(PLs),style=3)
for (i in 1:length(PLs)){
param <- paste0("Countries=all&RefYears=",year,"&PovertyLine=",PLs[i])
url <- paste0("http://iresearch.worldbank.org/PovcalNet/PovcalNetAPI.ashx?",param,"&display=c")
temp <- read.csv(url,header=T)
data.list[[i]] <- temp
setTxtProgressBar(pb,i)
}
close(pb)
data <- rbindlist(data.list)
data$diff <- abs(targetHC-data$HeadCount)
data.list <- list()
PLs <- seq(lowerguess,upperguess,by=precision)
pb <- txtProgressBar(min=0, max=length(PLs),style=3)
for (i in 1:length(PLs)){
param <- paste0("Countries=all&RefYears=",year,"&PovertyLine=",PLs[i])
url <- paste0("http://iresearch.worldbank.org/PovcalNet/PovcalNetAPI.ashx?",param,"&display=c")
temp <- read.csv(url,header=T)
data.list[[i]] <- temp
setTxtProgressBar(pb,i)
}
View(data)
#datatemp <- list()
#i <- 1
#for(country in unique(data$CountryName)){
#for(year in unique(data$RequestYear)){
#datatemp[[i]] <- data[which(CountryName==country&RequestYear==year&data$diff==min(data[which(RequestYear==year&CountryName==country)]$diff))]
#i = i + 1
#}
#}
#thresholds <- rbindlist(datatemp)
datadt <- as.data.table(data)
datadt$CountryYear <- paste0(datadt$CountryName,datadt$CoverageType,datadt$RequestYear)
datadt[datadt[, .I[diff == min(diff)], by=CountryYear]$V1]
datadt <- datadt[datadt[, .I[diff == min(diff)], by=CountryYear]$V1]
View(datadt)
datadt <- datadt[datasdt[, .I[PovertyLine==max(PovertyLine)], by=CountryYear]$V1]
datadt <- datadt[datadt[, .I[PovertyLine==max(PovertyLine)], by=CountryYear]$V1]
